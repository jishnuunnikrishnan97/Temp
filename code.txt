import pandas as pd

# Create a sample DataFrame
data = {'Date1': ['2023-10-25', '2023-10-26', '2023-10-27'],
        'Date2': ['2023-10-22', 'invalid', '2023-10-29']}

df = pd.DataFrame(data)

# Find columns with the same name
duplicate_columns = [col for col in df.columns if df.columns.tolist().count(col) > 1]

if len(duplicate_columns) == 2:
    # Attempt to convert both columns to date format
    try:
        for col in duplicate_columns:
            df[col] = pd.to_datetime(df[col])
    except pd.errors.OutOfBoundsDatetime:
        # Drop the column that gives an error when trying to convert
        df = df.drop(columns=duplicate_columns[1])
    except pd.errors.OutOfBoundsDatetime:
        # Drop the other column that gives an error
        df = df.drop(columns=duplicate_columns[0])

print(df)
